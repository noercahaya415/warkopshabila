<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Warung Kopi Shabila</title>
  <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@700&family=Montserrat:wght@400;600&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.7.1/dist/leaflet.css" />
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: 'Montserrat', sans-serif;
      background-color: #f9f5f0;
      color: #333;
      line-height: 1.6;
    }

    header {
      background: linear-gradient(135deg, #d92323 0%, #a31c1c 100%);
      color: white;
      text-align: center;
      padding: 2.5rem 1rem;
      box-shadow: 0 4px 20px rgba(0, 0, 0, 0.15);
      position: relative;
      overflow: hidden;
    }

    .logo-container {
      display: flex;
      justify-content: center;
      margin-bottom: 1.2rem;
    }

    .logo-img {
      height: 350px;
      filter: drop-shadow(0 3px 6px rgba(0, 0, 0, 0.3));
    }

    .delivery-text {
      font-family: 'Montserrat', sans-serif;
      font-size: 2rem;
      font-weight: 600;
      letter-spacing: 1.8px;
      text-transform: uppercase;
      background: rgba(0, 0, 0, 0.18);
      display: inline-block;
      padding: 0.8rem 2.5rem;
      border-radius: 50px;
      backdrop-filter: blur(8px);
      border: 1px solid rgba(255, 255, 255, 0.25);
      box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
    }

    main {
      display: flex;
      flex-wrap: wrap;
      padding: 2rem;
      max-width: 1200px;
      margin: 0 auto;
    }

    .menu-container {
      flex: 3;
      padding-right: 2rem;
    }

    .order-summary {
      flex: 1;
      background-color: white;
      padding: 1.8rem;
      border-radius: 12px;
      box-shadow: 0 4px 20px rgba(0, 0, 0, 0.08);
      position: sticky;
      top: 2rem;
      height: fit-content;
    }

    .fee-section {
      margin: 1rem 0;
      padding: 1rem;
      background: #fff8f8;
      border-radius: 8px;
      border: 1px solid #ffdddd;
    }

    .fee-section .form-group {
      margin-bottom: 0.8rem;
    }

    .fee-section label {
      font-size: 0.85rem;
      color: #d92323;
    }

    .fee-section input[type="number"] {
      padding: 0.5rem;
      width: 100%;
      border: 1px solid #ddd;
      border-radius: 4px;
      background-color: #f8f8f8;
    }

    #tax-toggle {
      margin-left: 0.5rem;
      transform: scale(1.2);
    }

    .customer-info {
      margin-top: 1.5rem;
      padding: 1.5rem;
      background: #f8f8f8;
      border-radius: 8px;
      border: 1px solid #eee;
    }

    .customer-info h4 {
      font-family: 'Playfair Display', serif;
      font-size: 1.2rem;
      margin-bottom: 1rem;
      color: #d92323;
    }

    .customer-info .form-group {
      margin-bottom: 1rem;
    }

    .customer-info label {
      display: block;
      margin-bottom: 0.3rem;
      font-size: 0.9rem;
      font-weight: 600;
      color: #555;
    }

    .customer-info input,
    .customer-info textarea {
      width: 100%;
      padding: 0.6rem;
      border: 1px solid #ddd;
      border-radius: 4px;
      font-family: 'Montserrat', sans-serif;
    }

    #mini-map {
      height: 200px;
      width: 100%;
      margin: 10px 0;
      border-radius: 8px;
      border: 1px solid #ddd;
      background-color: #f8f8f8;
    }

    .leaflet-container {
      background-color: #f8f8f8 !important;
    }

    .leaflet-marker-icon {
      filter: hue-rotate(200deg) !important;
    }

    .distance-info {
      margin-top: 5px;
      font-size: 0.9rem;
    }

    .distance-info strong {
      color: #d92323;
    }

    .menu-category h3 {
      font-family: 'Playfair Display', serif;
      background-color: #d92323;
      color: white;
      padding: 0.8rem 1.5rem;
      border-radius: 6px;
      margin-bottom: 1.5rem;
      font-size: 1.5rem;
      letter-spacing: 0.5px;
    }

    .menu-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
      gap: 2rem;
    }

    .menu-item {
      background-color: white;
      border-radius: 12px;
      overflow: hidden;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
      transition: transform 0.3s ease, box-shadow 0.3s ease;
    }

    .menu-item:hover {
      transform: translateY(-8px);
      box-shadow: 0 8px 20px rgba(0, 0, 0, 0.15);
    }

    .menu-item img {
      width: 100%;
      height: 200px;
      object-fit: cover;
    }

    .menu-item-content {
      padding: 1.5rem;
      display: flex;
      flex-direction: column;
      flex-grow: 1;
    }

    .menu-item h4 {
      font-family: 'Playfair Display', serif;
      font-size: 1.4rem;
      margin-bottom: 0.8rem;
      color: #d92323;
    }

    .menu-description {
      display: -webkit-box;
      -webkit-line-clamp: 3;
      -webkit-box-orient: vertical;
      overflow: hidden;
      text-overflow: ellipsis;
      margin-bottom: 1rem;
      font-size: 0.95rem;
      line-height: 1.5;
      color: #555;
      transition: all 0.4s ease;
    }

    .menu-description.expanded {
      -webkit-line-clamp: unset;
    }

    .read-more-btn {
      color: #d92323;
      background: none;
      border: none;
      cursor: pointer;
      padding: 0;
      font-size: 0.95rem;
      font-weight: 600;
      margin: 0.5rem 0 1.2rem;
      display: inline-block;
      align-self: flex-start;
      transition: color 0.3s;
    }

    .read-more-btn:hover {
      color: #a31c1c;
    }

    .price-controls {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-top: auto;
    }

    .price {
      font-weight: 700;
      color: #d92323;
      font-size: 1.2rem;
    }

    .quantity-controls {
      display: flex;
      align-items: center;
    }

    .quantity-controls button {
      background-color: #d92323;
      color: white;
      border: none;
      width: 30px;
      height: 30px;
      border-radius: 50%;
      cursor: pointer;
      font-size: 1.1rem;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: background-color 0.3s;
    }

    .quantity-controls button:hover {
      background-color: #a31c1c;
    }

    .quantity-controls span {
      margin: 0 12px;
      min-width: 24px;
      text-align: center;
      font-weight: 600;
    }

    #order-items {
      max-height: 300px;
      overflow-y: auto;
      margin-bottom: 1rem;
      padding-right: 0.5rem;
    }

    .order-item {
      display: flex;
      justify-content: space-between;
      padding: 0.6rem 0;
      border-bottom: 1px solid #eee;
      font-size: 0.9rem;
    }

    .order-item-name {
      flex: 2;
      font-weight: 500;
    }

    .order-item-price {
      flex: 1;
      text-align: right;
      font-weight: 600;
    }

    .order-summary h3 {
      font-family: 'Playfair Display', serif;
      font-size: 1.6rem;
      margin-bottom: 1.5rem;
      color: #d92323;
      text-align: center;
    }

    .order-summary p {
      margin: 1rem 0;
      font-size: 1.1rem;
    }

    .order-summary strong {
      font-weight: 600;
    }

    .order-button {
      display: block;
      background-color: #25D366;
      color: white;
      text-align: center;
      padding: 1rem;
      border-radius: 8px;
      text-decoration: none;
      font-weight: 600;
      font-size: 1.1rem;
      margin-top: 1.5rem;
      transition: all 0.3s;
      box-shadow: 0 4px 12px rgba(37, 211, 102, 0.3);
    }

    .order-button:hover {
      background-color: #128C7E;
      transform: translateY(-2px);
      box-shadow: 0 6px 16px rgba(37, 211, 102, 0.4);
    }

    @media (max-width: 992px) {
      .menu-container {
        padding-right: 1rem;
      }
    }

    @media (max-width: 768px) {
      main {
        flex-direction: column;
        padding: 1.5rem;
      }

      .menu-container {
        padding-right: 0;
        margin-bottom: 2rem;
      }
      
      .order-summary {
        position: static;
        margin-top: 1rem;
      }

      .delivery-text {
        font-size: 1.6rem;
        padding: 0.6rem 1.8rem;
      }
    }

    @media (max-width: 480px) {
      .menu-grid {
        grid-template-columns: 1fr;
      }

      .delivery-text {
        font-size: 1.3rem;
        padding: 0.5rem 1.5rem;
      }

      #mini-map {
        height: 200px;
        width: 100%;
        margin: 10px 0;
        border-radius: 8px;
        border: 1px solid #ddd;
      }

     .leaflet-container {
        background-color: #f8f8f8 !important;
      }

     .distance-info {
        margin-top: 5px;
        font-size: 0.9rem;
      }
    }
  </style>
</head>
<body>
  <header>
    <div class="logo-container">
      <img src="logo.png" alt="Warung Kopi Shabila" class="logo-img">
    </div>    
    <div class="delivery-text">Online Delivery Order</div>
  </header>

  <main>
    <section class="menu-container" id="menu-list">
      <!-- Tambahkan instruksi pemesanan di sini -->
      <div class="order-instruction" style="background-color: #fff; padding: 1.5rem; border-radius: 8px; margin-bottom: 2rem; box-shadow: 0 2px 10px rgba(0,0,0,0.1);">
        <h3 style="font-family: 'Playfair Display', serif; color: #d92323; margin-bottom: 1rem; text-align: center;">Cara Memesan</h3>
        <ol style="padding-left: 1.5rem; color: #555;">
          <li style="margin-bottom: 0.5rem;">Silakan klik tombol <strong>Tambah (+)/Kurang (-)</strong> pada masing-masing menu untuk mengatur jumlah pesanan Anda</li>
          <li style="margin-bottom: 0.5rem;">Pesanan Anda akan otomatis muncul di keranjang sebelah kanan</li>
          <li style="margin-bottom: 0.5rem;">Isi data diri dan alamat lengkap, letakkan pin lokasi secara akurat sesuai dengan alamat Anda</li>
          <li>Tambahkan catatan jika ada permintaan khusus, lalu klik <strong>Pesan via WhatsApp</strong></li>
          </ol>
          <p style="text-align: center; margin-top: 1rem; font-style: bold; color: #777;">Selamat menikmati hidangan lezat kami!</p>
      </div>     
    </section>

    <aside class="order-summary">
      <h3>Pesanan Anda</h3>
      <div id="order-items"></div>
      <p><strong>Subtotal:</strong> <span id="subtotal">Rp 0</span></p>

      <div class="fee-section">
        <div class="form-group">
          <label for="delivery-fee">Ongkos Kirim (Rp)</label>
          <input type="number" id="delivery-fee" name="delivery-fee" min="0" value="0" readonly>
        </div>
        <div class="form-group">
          <label for="service-fee">Biaya Servis (Rp)</label>
          <input type="number" id="service-fee" name="service-fee" min="0" value="0">
        </div>
        <div class="form-group">
          <label>
            <input type="checkbox" id="tax-toggle" checked>
            Pajak (0%)
          </label>
        </div>
      </div>

      <p><strong>Total:</strong> <span id="total">Rp 0</span></p>

      <div class="customer-info">
        <h4>Informasi Pelanggan</h4>
        <form id="customer-form">
          <div class="form-group">
            <label for="nama">Nama Lengkap</label>
            <input type="text" id="nama" name="nama" required>
          </div>
          <div class="form-group">
            <label for="telepon">Nomor Telepon</label>
            <input type="tel" id="telepon" name="telepon" required>
          </div>
          <div class="form-group">
            <label for="alamat">Alamat Lengkap</label>
            <textarea id="alamat" name="alamat" rows="2" required></textarea>
          </div>
          <div class="form-group">
            <label for="lokasi">Pin Lokasi Anda:</label>
            <div id="mini-map"></div>
            <div class="distance-info">
              <strong>Jarak:</strong> <span id="jarak-display">0 km</span>
              <input type="hidden" id="jarak" name="jarak" value="0">
              <input type="hidden" id="lokasi-lat" name="lokasi-lat">
              <input type="hidden" id="lokasi-lng" name="lokasi-lng">
            </div>
          </div>
          <div class="form-group">
            <label for="catatan">Catatan Tambahan</label>
            <textarea id="catatan" name="catatan" rows="2"></textarea>
          </div>
        </form>
      </div>

      <a id="wa-link" href="#" target="_blank" class="order-button">Pesan via WhatsApp</a>
    </aside>
  </main>

  <script src="https://unpkg.com/leaflet@1.7.1/dist/leaflet.js"></script>
  <script>
    let cart = [];
    // Koordinat rumah makan (sesuaikan dengan lokasi sebenarnya)
    const RESTAURANT_LOCATION = {
      lat: -6.3278919,
      lng: 106.6734099,
      name: "Warkop Shabila"
    };
 
    let map, userMarker;

    // Fungsi inisialisasi peta
    function initMap() {
      map = L.map('mini-map').setView([RESTAURANT_LOCATION.lat, RESTAURANT_LOCATION.lng], 14);
      
      L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png').addTo(map);

      // Marker restoran
      L.marker([RESTAURANT_LOCATION.lat, RESTAURANT_LOCATION.lng])
        .addTo(map)
        .bindPopup(`<b>${RESTAURANT_LOCATION.name}</b>`)
        .openPopup();

      // Marker pengguna (bisa digeser)
      userMarker = L.marker([RESTAURANT_LOCATION.lat, RESTAURANT_LOCATION.lng], {
        draggable: true
      }).addTo(map);

      // Cari lokasi pengguna otomatis
      locateUser();

      // Event saat marker digeser
      userMarker.on('dragend', function(e) {
        updateLocation(userMarker.getLatLng());
      });
    }

    // Fungsi deteksi lokasi pengguna
    function locateUser() {
      if (navigator.geolocation) {
        navigator.geolocation.getCurrentPosition(
          (position) => {
            const userLoc = {
              lat: position.coords.latitude,
              lng: position.coords.longitude
            };
            userMarker.setLatLng(userLoc);
            map.setView(userLoc, 15);
            updateLocation(userLoc);
          },
          (error) => {
            console.log("Pengguna menolak akses lokasi");
            updateLocation(RESTAURANT_LOCATION);
          }
        );
      }
    }

    // Fungsi update lokasi
    function updateLocation(pos) {
      document.getElementById('lokasi-lat').value = pos.lat;
      document.getElementById('lokasi-lng').value = pos.lng;
      calculateDistance(pos);
    }

    // Fungsi hitung jarak
    function calculateDistance(userPos) {
      const R = 6371; // Radius bumi dalam km
      const dLat = (userPos.lat - RESTAURANT_LOCATION.lat) * Math.PI / 180;
      const dLon = (userPos.lng - RESTAURANT_LOCATION.lng) * Math.PI / 180;
      const a = 
        Math.sin(dLat/2) * Math.sin(dLat/2) +
        Math.cos(RESTAURANT_LOCATION.lat * Math.PI / 180) * 
        Math.cos(userPos.lat * Math.PI / 180) * 
        Math.sin(dLon/2) * Math.sin(dLon/2);
      const c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1-a));
      const distance = R * c;
      
      // Pembulatan ke atas ke 1 desimal
      const roundedDistance = Math.ceil(distance * 10) / 10;
      document.getElementById('jarak-display').textContent = `${roundedDistance} km`;
      document.getElementById('jarak').value = roundedDistance;
      
      // Perhitungan ongkir baru:
      // - 0-2 km: Gratis
      // - 2.1-3 km: Rp 5.000
      // - Setiap penambahan 1 km: +Rp 5.000
      let deliveryFee = 0;
      if (roundedDistance > 2) {
        const kmLebih = Math.ceil(roundedDistance - 2); // Pembulatan ke atas
        deliveryFee = kmLebih * 5000;
      }
      
      document.getElementById('delivery-fee').value = deliveryFee;
      updateOrderSummary();
    }

    function createMenuItem(item) {
      const menuItem = document.createElement('div');
      menuItem.className = 'menu-item';
      
      const img = document.createElement('img');
      img.src = item.FOTO;
      img.alt = item['NAMA MENU'];
      
      const contentDiv = document.createElement('div');
      contentDiv.className = 'menu-item-content';
      
      const title = document.createElement('h4');
      title.textContent = item['NAMA MENU'];
      
      const descContainer = document.createElement('div');
      descContainer.className = 'menu-description';
      descContainer.textContent = item.DESKRIPSI;
      
      const readMoreBtn = document.createElement('button');
      readMoreBtn.className = 'read-more-btn';
      readMoreBtn.textContent = 'More';
      
      const priceControls = document.createElement('div');
      priceControls.className = 'price-controls';
      
      const priceSpan = document.createElement('span');
      priceSpan.className = 'price';
      priceSpan.textContent = `Rp ${item.HARGA.toLocaleString('id-ID')}`;
      
      const quantityDiv = document.createElement('div');
      quantityDiv.className = 'quantity-controls';
      quantityDiv.innerHTML = `
        <button class="decrease">-</button>
        <span class="quantity">0</span>
        <button class="increase">+</button>
      `;
      
      priceControls.appendChild(priceSpan);
      priceControls.appendChild(quantityDiv);
      
      contentDiv.appendChild(title);
      contentDiv.appendChild(descContainer);
      contentDiv.appendChild(readMoreBtn);
      contentDiv.appendChild(priceControls);
      
      menuItem.appendChild(img);
      menuItem.appendChild(contentDiv);
      
      readMoreBtn.addEventListener('click', (e) => {
        e.preventDefault();
        descContainer.classList.toggle('expanded');
        readMoreBtn.textContent = 
          descContainer.classList.contains('expanded') ? 'Less' : 'More';
      });
      
      const increaseBtn = quantityDiv.querySelector('.increase');
      const decreaseBtn = quantityDiv.querySelector('.decrease');
      const quantitySpan = quantityDiv.querySelector('.quantity');
      
      increaseBtn.addEventListener('click', () => {
        const currentQty = parseInt(quantitySpan.textContent);
        quantitySpan.textContent = currentQty + 1;
        updateCart(item, currentQty + 1);
      });
      
      decreaseBtn.addEventListener('click', () => {
        const currentQty = parseInt(quantitySpan.textContent);
        if (currentQty > 0) {
          quantitySpan.textContent = currentQty - 1;
          updateCart(item, currentQty - 1);
        }
      });
      
      return menuItem;
    }

    function updateCart(item, quantity) {
      const existingItemIndex = cart.findIndex(cartItem => cartItem.name === item['NAMA MENU']);
      
      if (existingItemIndex !== -1) {
        if (quantity === 0) {
          cart.splice(existingItemIndex, 1);
        } else {
          cart[existingItemIndex].quantity = quantity;
        }
      } else if (quantity > 0) {
        cart.push({
          name: item['NAMA MENU'],
          price: item.HARGA,
          quantity: quantity
        });
      }
      
      updateOrderSummary();
    }

    function updateOrderSummary() {
      const orderItems = document.getElementById('order-items');
      const subtotalElement = document.getElementById('subtotal');
      const totalElement = document.getElementById('total');
      const waLink = document.getElementById('wa-link');
      
      orderItems.innerHTML = '';
      
      let subtotal = 0;
      
      cart.forEach(item => {
        const itemTotal = item.price * item.quantity;
        subtotal += itemTotal;
        
        const orderItem = document.createElement('div');
        orderItem.className = 'order-item';
        orderItem.innerHTML = `
          <div class="order-item-name">${item.name}</div>
          <div class="order-item-quantity">${item.quantity}</div>
          <div class="order-item-price">Rp ${itemTotal.toLocaleString('id-ID')}</div>
        `;
        orderItems.appendChild(orderItem);
      });
      
      const deliveryFee = parseInt(document.getElementById('delivery-fee').value) || 0;
      const serviceFee = parseInt(document.getElementById('service-fee').value) || 0;
      const applyTax = document.getElementById('tax-toggle').checked;
      const tax = applyTax ? subtotal * 0 : 0;

      const total = subtotal + deliveryFee + serviceFee + tax;

      subtotalElement.textContent = `Rp ${subtotal.toLocaleString('id-ID')}`;
      
      orderItems.innerHTML += `
        <div class="order-item">
          <div class="order-item-name">Ongkos Kirim</div>
          <div class="order-item-price">Rp ${deliveryFee.toLocaleString('id-ID')}</div>
        </div>
        <div class="order-item">
          <div class="order-item-name">Biaya Servis</div>
          <div class="order-item-price">Rp ${serviceFee.toLocaleString('id-ID')}</div>
        </div>
        ${applyTax ? `
        <div class="order-item">
          <div class="order-item-name">Pajak (10%)</div>
          <div class="order-item-price">Rp ${tax.toLocaleString('id-ID')}</div>
        </div>
        ` : ''}
      `;

      totalElement.textContent = `Rp ${total.toLocaleString('id-ID')}`;

      if (cart.length > 0) {
        const customerForm = document.getElementById('customer-form');
        const nama = customerForm.nama.value;
        const telepon = customerForm.telepon.value;
        const alamat = customerForm.alamat.value;
        const catatan = customerForm.catatan.value;
        const jarak = document.getElementById('jarak').value;
        const lokasiLat = document.getElementById('lokasi-lat').value;
        const lokasiLng = document.getElementById('lokasi-lng').value;
        
        const now = new Date();
        const options = { 
          weekday: 'long', 
          day: 'numeric', 
          month: 'long', 
          year: 'numeric',
          hour: '2-digit', 
          minute: '2-digit'
        };
        const orderTime = now.toLocaleDateString('id-ID', options);
        
        let message = `⏰ *Waktu Pemesanan:* ${orderTime}\n\n`;
        message += `──────────────────────\n\n`;
        message += `Halo, saya ingin memesan:\n\n`;
        message += `*Nama:* ${nama || '-'}\n`;
        message += `*No. Telepon:* ${telepon || '-'}\n`;
        message += `*Alamat:* ${alamat}\n`;
        message += `*Lokasi:* https://maps.google.com/?q=${lokasiLat},${lokasiLng}\n`;
        message += `*Jarak dari restoran:* ${jarak} km\n\n`;
        
        message += `*Detail Pesanan:*\n`;
        cart.forEach(item => {
          message += `- ${item.name} (${item.quantity}x) - Rp ${(item.price * item.quantity).toLocaleString('id-ID')}\n`;
        });
        
        message += `\n*Subtotal:* Rp ${subtotal.toLocaleString('id-ID')}\n`;
        if (deliveryFee > 0) message += `*Ongkos Kirim:* Rp ${deliveryFee.toLocaleString('id-ID')}\n`;
        if (serviceFee > 0) message += `*Biaya Servis:* Rp ${serviceFee.toLocaleString('id-ID')}\n`;
        if (applyTax) message += `*Pajak (10%):* Rp ${tax.toLocaleString('id-ID')}\n`;
        message += `*Total:* Rp ${total.toLocaleString('id-ID')}\n`;
        
        if (catatan) message += `\n*Catatan:* ${catatan}\n`;
        message += `\nTerima kasih!`;
        
        waLink.href = `https://wa.me/6282128037436?text=${encodeURIComponent(message)}`;
        waLink.style.display = 'block';
      } else {
        waLink.style.display = 'none';
      }
    }

    // Data menu minuman saja (sudah diperbaiki syntax-nya)
    const menuData = {
      "minuman": [
        {
          "NAMA MENU": "Beng-Beng",
          "FOTO": "images/bengbeng6000.jpg",
          "HARGA": 6000,
          "DESKRIPSI": "Minuman coklat Beng-Beng yang creamy"
        },
        {
          "NAMA MENU": "Chocolatos Coklat",
          "FOTO": "images/chocolatoscoklat6000.jpg",
          "HARGA": 6000,
          "DESKRIPSI": "Minuman coklat Chocolatos"
        },
        {
          "NAMA MENU": "chocolatos Creamy",
          "FOTO": "images/chocolatoscreamy6000.jpg",
          "HARGA": 6000,
          "DESKRIPSI": "Minuman Chocolatos rasa creamy"
        },
        {
          "NAMA MENU": "Chocolatos Matcha",
          "FOTO": "images/chocolatosmatcha6000.jpg",
          "HARGA": 6000,
          "DESKRIPSI": "Minuman Chocolatos rasa matcha"
        },
        {
          "NAMA MENU": "Good Day Cappuccinno",
          "FOTO": "images/gooddaycappuccino6000.jpg",
          "HARGA": 6000,
          "DESKRIPSI": "Good Day rasa cappuccino"
        },
        {
          "NAMA MENU": "Good Day Carrebian Nut",
          "FOTO": "images/gooddaycarrebiannut6000.png",
          "HARGA": 6000,
          "DESKRIPSI": "Good Day rasa Carrebian Nut"
        },
        {
          "NAMA MENU": "Good Day Chococinno",
          "FOTO": "images/gooddaychococinno6000.png",
          "HARGA": 6000,
          "DESKRIPSI": "Good Day rasa Chococinno"
        },
        {
          "NAMA MENU": "Good Day Mocacinno",
          "FOTO": "images/gooddaymocacinno6000.png",
          "HARGA": 6000,
          "DESKRIPSI": "Good Day rasa Mocacinno"
        },
        {
          "NAMA MENU": "Good Day Original",
          "FOTO": "images/gooddayoriginal6000.png",
          "HARGA": 6000,
          "DESKRIPSI": "Good Day rasa original"
        },
        {
          "NAMA MENU": "Thai Tea",
          "FOTO": "images/thaitea.jpg",
          "HARGA": 6000,
          "DESKRIPSI": "Minuman Thai Tea segar"
        },
        {
          "NAMA MENU": "Indocafe Coffemix",
          "FOTO": "images/indocafecoffemix5000.jpg",
          "HARGA": 5000,
          "DESKRIPSI": "Kopi Indocafe Coffemix"
        },
        {
          "NAMA MENU": "Jahe Susu",
          "FOTO": "images/jahesusu5000.jpg",
          "HARGA": 5000,
          "DESKRIPSI": "Jahe susu hangat"
        },
        {
          "NAMA MENU": "Liong Bulan",
          "FOTO": "images/liongbulan5000.jpg",
          "HARGA": 5000,
          "DESKRIPSI": "Minuman Liong Bulan"
        },
        {
          "NAMA MENU": "Luwak White Koffe",
          "FOTO": "images/luwakwhitekoffe5000.jpg",
          "HARGA": 5000,
          "DESKRIPSI": "Kopi Luwak White"
        },
        {
          "NAMA MENU": "Tea Jus",
          "FOTO": "images/teajus3000.jpg",
          "HARGA": 3000,
          "DESKRIPSI": "Teh jus segar"
        }
      ]
    };

    // Fungsi displayMenu yang disederhanakan (hanya untuk minuman)
    function displayMenu() {
      const menuList = document.getElementById('menu-list');
      
      // Hanya buat grid untuk minuman
      if (menuData.minuman && !document.getElementById('drink-grid')) {
        const drinkSection = document.createElement('div');
        drinkSection.className = 'menu-category';
        drinkSection.innerHTML = '<h3>Minuman</h3><div class="menu-grid" id="drink-grid"></div>';
        menuList.appendChild(drinkSection);
        
        menuData.minuman.forEach(item => {
          document.getElementById('drink-grid').appendChild(createMenuItem(item));
        });
      }
    }
    
    document.addEventListener('DOMContentLoaded', () => {
      displayMenu();
      initMap();
      document.getElementById('service-fee').addEventListener('input', updateOrderSummary);
      document.getElementById('tax-toggle').addEventListener('change', updateOrderSummary);
      document.getElementById('customer-form').addEventListener('input', updateOrderSummary);
    });

    async function sendToGoogleSheets() {
      const data = {
        nama: document.getElementById('nama').value,
        telepon: document.getElementById('telepon').value,
        alamat: document.getElementById('alamat').value,
        items: cart.map(item => `${item.name} (${item.quantity}x)`),
        subtotal: parseFloat(
          document.getElementById('subtotal').textContent
            .replace("Rp ", "")
            .replace(/\./g, '') // Hapus semua titik pemisah ribuan
        ),
        ongkir: parseFloat(
          document.getElementById('delivery-fee').value
            .replace(/\./g, '') // Hapus titik jika ada
        ),
        pajak: document.getElementById('tax-toggle').checked ? 
               parseFloat(
                 document.getElementById('subtotal').textContent
                   .replace("Rp ", "")
                   .replace(/\./g, '')
               ) * 0 : 0,
       total: parseFloat(
         document.getElementById('total').textContent
           .replace("Rp ", "")
           .replace(/\./g, '')
       ),
       catatan: document.getElementById('catatan').value
     };

    try {
      await fetch('https://script.google.com/macros/s/AKfycbyNwnKbK1UfIAqUd04iOh2WKlFUA2mx_DnyPgl7KVKQVXoX0PkygpGU7bjHmOpT0UPy/exec', {
      method: 'POST',
      body: JSON.stringify(data)
      });
      console.log("Data tersimpan di Google Sheets!");
    } catch (error) {
      console.error("Error:", error);
    }
  }

  // Panggil fungsi ini bersamaan dengan WA
  document.getElementById('wa-link').addEventListener('click', function(e) {
    e.preventDefault();
    sendToGoogleSheets();
    window.open(this.href, '_blank'); // Buka WA
  });

  </script>
</body>
</html>
